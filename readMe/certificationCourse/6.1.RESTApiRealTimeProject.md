# Spring boot REST API real time project
- REST API with spring boot that connects to a database
- **API Requirement**
- Create a REST API for the Employee Directory
- REST clients should be able to 
- Get a list of employees 
- Get a single employee by id 
- Add a new employee 
- Update an employee 
- Delete an employee

| HTTP METHOD | End Point                  | CRUD action                 |
|-------------|----------------------------|-----------------------------|
| POST        | api/employees              | Create a new Employee       |
| GET         | api/employees              | Read a list of Employee     |
| GET         | api/employees/{employeeId} | Red a single Employee       |
| PUT         | api/employees              | Update an existing Employee |
| DELETE      | api/employees/{employeeId} | Delete an existing Employee |

### Development Process
1. Set up Database Dev Environment
2. Create Spring Boot project using Spring Initializer
3. Get list of employees
4. Get single employee ky ID
5. Add a new employee
6. Update an existing employee
7. Delete an existing employee
### Application Architecture
- Employee REST Controller <=> EmployeeService <=> Employee DAO <=> Database
### Create .Sql file
- employee.sql
- Create employee.sql file
- Create a new database table: employee
- Load table with sample data
- Create an employee-directory.sql
```
CREATE DATABASE  IF NOT EXISTS `employee_directory`;
USE `employee_directory`;

--
-- Table structure for table `employee`
--

DROP TABLE IF EXISTS `employee`;

CREATE TABLE `employee` (
  `id` int NOT NULL AUTO_INCREMENT,
  `first_name`varchar(45) DEFAULT NULL,
  `last_name` varchar(45) DEFAULT NULL,
  `email` varchar(45) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=latin1;

INSERT INTO `employee` VALUES
		(1, 'siba1','prasad1','siba1@gmail.com'),
        (2, 'siba2','prasad2','siba2@gmail.com'),
        (3, 'siba3','prasad3','siba3@gmail.com'),
        (4, 'siba4','prasad4','siba4@gmail.com'),
        (5, 'siba5','prasad5','siba5@gmail.com');
```
- Open MySql Workbench
- Click on one of the connection in My workbench
- From File, Import the employee-directory.sql file (file -> Open Sql Script -> select the file)
- Create the file using MySql Workbench. File -> new Model -> paste the above query -> file -> save as employee-directory.sql 
- Now click on the lighting icon
- You wil see below message
- 5 row(s) affected Records: 5  Duplicates: 0  Warnings: 0
- Check if the data is there in database or not.
- Use the query in query tab and execute ```SELECT * FROM employee_directory.employee;```
- You will see the table data after execution.
- Go to https://start.spring.io
- Add dependencies
  - Spring Web WEB 
  - Spring Data JPA SQL 
  - Spring Boot DevTools DEVELOPER TOOLS 
  - MySQL Driver SQL
- Download the project and sync maven or gradle
### Create JPA DAO in spring boot
Employee REST Controller <=> Employee Service <=> Employee DAO <=> Database
### Development Process
- Set up Database Dev Environment 
1) Create Spring Boot project using Spring Initializer 
2) Get list of employees 
3) Get single employee by ID 
4) Add a new employee 
5) Update an existing employee 
6) Delete an existing employee
### DAO implementation
```
@Repository
public class EmployeeDAOJpaImpl implements EmployeeDAO {
private EntityManager entityManager;
@Autowired
public EmployeeDAOJpaImpl (EntityManager theEntityManager)
entityManager = theEntityManager;
}
}
```
- Get List of employees
```
 @Override
    public List<Employee> findAll() {

        // create a query
        TypedQuery<Employee> theQuery = entityManager.createQuery("from Employee", Employee.class);

        // execute query and get result list
        List<Employee> employees = theQuery.getResultList();

        // return the results
        return employees;
    }
```
### 2 Development process for DAO
1. Update db configs in application.properties
2. Create Employee Entity
3. Create DAO interface
4. Create DAO Implementation
5. Create REST Controller to use DAO
### Make changes in the IDE - Intellij Idea
- Go to settings -> Build, Execution, Deployment
- Select Compiler -> Tick -> Build Project automatically
- Go to advanced settings -> tick -> Allow Auto-make to start even if developed application is currently running.
### Update application.properties file
```
spring.datasource.url=jdbc:mysql://localhost:3306/employee_directory
spring.datasource.username=springstudent
spring.datasource.password=springstudent
```
- Create EmployeeDAO interface
```
public interface EmployeeDAO {
    List<Employee> findAll();
}
```
- Create Implementation class for above
```
@Repository
public class EmployeeDAOJpaImpl implements EmployeeDAO {
    // define field for entitymanager
    private EntityManager entityManager;
    // set up constructor injection
    @Autowired
    public EmployeeDAOJpaImpl(EntityManager theEntityManager) {
        entityManager = theEntityManager;
    }
    @Override
    public List<Employee> findAll() {
        // create a query
        TypedQuery<Employee> theQuery = entityManager.createQuery("from Employee", Employee.class);
        // execute query and get result list
        List<Employee> employees = theQuery.getResultList();
        // return the results
        return employees;
    }
}
```
- Create Employee Entity class, add all getter and setter methods
```
@Entity
@Table(name="employee")
public class Employee {
    // define fields
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Column(name="id")
    private int id;

    @Column(name="first_name")
    private String firstName;

    @Column(name="last_name")
    private String lastName;

    @Column(name="email")
    private String email;

    // define constructors
    public Employee() {

    }
    public Employee(String firstName, String lastName, String email) {
        this.firstName = firstName;
        this.lastName = lastName;
        this.email = email;
    }
```
- Make sure that you will update application.properties
- Now Run the main application.
- ```http://localhost:8080/api/employees```
- You will see list of employees Json Array.
### Define Service with @Service Annotation